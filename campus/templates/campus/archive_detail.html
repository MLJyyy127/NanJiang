{% extends 'base.html' %}
{% load static %}

{% block title %}{{ case.title }} - æ ¡å²æ¡£æ¡ˆ{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{% static 'campus/css/archive.css' %}">
<style>
    .case-title {
        color: #66ccff;
        font-size: 28px;
        margin: 0 0 15px 0;
    }
    
    .case-meta {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 15px;
        margin-bottom: 20px;
        padding: 20px;
        background: rgba(0, 0, 0, 0.3);
        border-radius: 6px;
    }
    
    .meta-card {
        text-align: center;
        padding: 15px;
        background: #111;
        border-radius: 4px;
        border: 1px solid #333;
    }
    
    .meta-label {
        color: #888;
        font-size: 14px;
        margin-bottom: 5px;
    }
    
    .meta-value {
        color: #66ccff;
        font-size: 18px;
        font-weight: bold;
    }
    
    .case-content {
        background: #111;
        padding: 30px;
        border-radius: 8px;
        margin-bottom: 30px;
        border: 1px solid #222;
    }
    
    .case-content h3 {
        color: #4db8ff;
        margin: 25px 0 15px 0;
        padding-bottom: 10px;
        border-bottom: 1px solid #333;
    }
    
    .case-content h3:first-child {
        margin-top: 0;
    }
    
    .case-clues {
        background: rgba(13, 27, 42, 0.5);
        border: 1px solid #1e3a5f;
        padding: 20px;
        border-radius: 6px;
        margin: 20px 0;
    }
    
    .back-button {
        display: inline-block;
        background: linear-gradient(135deg, #003366, #006699);
        color: white;
        text-decoration: none;
        padding: 12px 25px;
        border-radius: 6px;
        margin-bottom: 20px;
        transition: all 0.3s;
    }
    
    .back-button:hover {
        background: linear-gradient(135deg, #004488, #0088cc);
        transform: translateY(-2px);
    }
    
    .related-cases {
        margin-top: 40px;
        padding-top: 30px;
        border-top: 1px solid #333;
    }
    
    .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        margin-top: 20px;
    }
    
    .related-card {
        background: #111;
        border: 1px solid #222;
        border-radius: 6px;
        padding: 20px;
        transition: all 0.3s;
    }
    
    .related-card:hover {
        border-color: #66ccff;
        transform: translateY(-3px);
    }
    
    .related-card h4 {
        color: #66ccff;
        margin: 0 0 10px 0;
    }
    
    .related-link {
        color: #4db8ff;
        text-decoration: none;
        font-size: 14px;
        margin-top: 10px;
        display: inline-block;
    }
</style>
{% endblock %}

{% block content %}
<div class="archive-container">
    <!-- è¿”å›æŒ‰é’® -->
    <a href="{% url 'campus:archive_index' %}" class="back-button">â† è¿”å›æ¡£æ¡ˆåˆ—è¡¨</a>
    
    <!-- æ¡ˆä»¶å¤´éƒ¨ä¿¡æ¯ -->
    <div class="case-header">
        <h1 class="case-title">{{ case.title }}</h1>
        <div class="case-meta">
            <div class="meta-card">
                <div class="meta-label">æ¡£æ¡ˆç¼–å·</div>
                <div class="meta-value">{{ case.case_id }}</div>
            </div>
            <div class="meta-card">
                <div class="meta-label">æ¡ˆä»¶çŠ¶æ€</div>
                <div class="meta-value">{{ status_text }}</div>
            </div>
            <div class="meta-card">
                <div class="meta-label">å‘ç”Ÿæ—¶é—´</div>
                <div class="meta-value">{{ case.date }}</div>
            </div>
            <div class="meta-card">
                <div class="meta-label">å‘ç”Ÿåœ°ç‚¹</div>
                <div class="meta-value">{{ case.location }}</div>
            </div>
        </div>
        
        <div class="case-tags">
            {% for tag in case.tags %}
            <span class="tag">{{ tag }}</span>
            {% endfor %}
        </div>
    </div>
    
    <!-- æ¡ˆä»¶å†…å®¹ -->
    <div class="case-content">
        <!-- æ¡ˆä»¶çº¿ç´¢ -->
        {% if case.clues %}
        <div class="case-clues">
            <h3>ğŸ“ ç°åœºçº¿ç´¢</h3>
            <ul>
                {% for clue in case.clues %}
                <li>{{ clue }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        <!-- æ¡ˆä»¶è¯¦ç»†å†…å®¹ -->
        <div class="case-details">
            {{ case.content|safe }}
        </div>
        
        <!-- è­¦å‘Šä¿¡æ¯ -->
        {% if case.warning %}
        <div class="archive-warning {% if case.danger %}danger{% endif %}">
            <strong>âš  è­¦å‘Šï¼š</strong> {{ case.warning }}
        </div>
        {% endif %}
        
        <!-- å¤‡æ³¨ä¿¡æ¯ -->
        {% if case.note %}
        <div class="archive-note">
            <strong>ğŸ“Œ å¤‡æ³¨ï¼š</strong> {{ case.note }}
        </div>
        {% endif %}
    </div>
    
    <!-- ç›¸å…³æ¡ˆä»¶ -->
    {% if related_cases %}
    <div class="related-cases">
        <h3>ğŸ“š ç›¸å…³æ¡ˆä»¶</h3>
        <div class="related-grid">
            {% for related in related_cases %}
            <div class="related-card">
                <h4>{{ related.title }}</h4>
                <p><strong>ç¼–å·ï¼š</strong>{{ related.case_id }}</p>
                <p><strong>çŠ¶æ€ï¼š</strong>
                    {% if related.status == 'unsolved' %}æœªè§£å†³
                    {% elif related.status == 'sealed' %}å·²å°å­˜
                    {% elif related.status == 'investigating' %}è°ƒæŸ¥ä¸­
                    {% endif %}
                </p>
                <a href="{% url 'campus:archive_detail' related.id %}" class="related-link">æŸ¥çœ‹è¯¦æƒ… â†’</a>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>
{% endblock %}